(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{Ru5I:function(t,e,c){"use strict";c.r(e);var i=c("3Pt+"),o=c("hctd"),r=c("fXoL"),n=c("ofXK"),a=c("eIep"),s=c("YIVz"),d=c("yp1H"),l=c("MSSf"),b=c("Xlwt"),u=c("tyNb"),m=c("tmTa"),p=c("TY1r");const h=["mat-button","","color","primary",3,"routerLink"],f=["mat-table","",1,"mat-elevation-z8",3,"dataSource"],g=["matColumnDef","codigo"],y=["mat-header-cell","",4,"matHeaderCellDef"],Z=["mat-cell","",4,"matCellDef"],v=["matColumnDef","descripcion"],w=["matColumnDef","unidad"],C=["matColumnDef","cantidad"],I=["matColumnDef","precio"],D=["matColumnDef","parcial"],S=["matColumnDef","edit"],R=["mat-footer-cell","",4,"matFooterCellDef"],G=["matColumnDef","delete"],H=["mat-header-row","",4,"matHeaderRowDef"],P=["mat-row","",4,"matRowDef","matRowDefColumns"],U=["mat-header-cell",""];function V(t,e){1&t&&(r.bc(0,"th",U),r.Hc(1," C\xf3digo "),r.Zb())}const x=["mat-cell",""];function M(t,e){if(1&t&&(r.bc(0,"td",x),r.Hc(1),r.Zb()),2&t){const t=e.$implicit;r.yc(1),r.Jc(" ",t.codigo," ")}}function O(t,e){1&t&&(r.bc(0,"th",U),r.Hc(1," Descripci\xf3n "),r.Zb())}function k(t,e){if(1&t&&(r.bc(0,"td",x),r.Hc(1),r.Zb()),2&t){const t=e.$implicit;r.yc(1),r.Jc(" ",t.descripcion," ")}}function A(t,e){1&t&&(r.bc(0,"th",U),r.Hc(1," Unidad "),r.Zb())}function T(t,e){if(1&t&&(r.bc(0,"td",x),r.Hc(1),r.Zb()),2&t){const t=e.$implicit;r.yc(1),r.Jc(" ",t.unidad," ")}}function X(t,e){1&t&&(r.bc(0,"th",U),r.Hc(1," Cantidad "),r.Zb())}function j(t,e){if(1&t&&(r.bc(0,"td",x),r.Hc(1),r.Zb()),2&t){const t=e.$implicit;r.yc(1),r.Jc(" ",t.cantidad," ")}}function Y(t,e){1&t&&(r.bc(0,"th",U),r.Hc(1," Valor Unitario "),r.Zb())}function N(t,e){if(1&t&&(r.bc(0,"td",x),r.Hc(1),r.nc(2,"currency"),r.Zb()),2&t){const t=e.$implicit;r.yc(1),r.Jc(" ",r.oc(2,1,t.valorUnitario)," ")}}function $(t,e){1&t&&(r.bc(0,"th",U),r.Hc(1," Valor Parcial "),r.Zb())}function B(t,e){if(1&t&&(r.bc(0,"td",x),r.Hc(1),r.nc(2,"currency"),r.Zb()),2&t){const t=e.$implicit;r.yc(1),r.Jc(" ",r.oc(2,1,t.valorUnitario*t.cantidad)," ")}}function J(t,e){1&t&&r.Vb(0,"th",U)}function L(t,e){1&t&&r.Vb(0,"th",U)}const z=["mat-icon-button","",3,"routerLink"],E=function(t){return["/budget/edit",t]};function _(t,e){if(1&t&&(r.bc(0,"td",x),r.bc(1,"a",z),r.bc(2,"mat-icon"),r.Hc(3,"edit"),r.Zb(),r.Zb(),r.Zb()),2&t){const t=e.$implicit;r.yc(1),r.rc("routerLink",r.sc(1,E,t.id))}}const q=["mat-footer-cell",""];function F(t,e){1&t&&r.Vb(0,"td",q)}function K(t,e){1&t&&r.Vb(0,"th",U)}function Q(t,e){1&t&&(r.bc(0,"th",U),r.Hc(1," Porcentaje "),r.Zb())}const W=["mat-icon-button","","aria-label","Example icon-button with a heart icon"];function tt(t,e){1&t&&(r.bc(0,"td",x),r.bc(1,"button",W),r.bc(2,"mat-icon"),r.Hc(3,"delete"),r.Zb(),r.Zb(),r.Zb())}function et(t,e){1&t&&r.Vb(0,"td",q)}const ct=["mat-header-row",""];function it(t,e){1&t&&r.Vb(0,"tr",ct)}const ot=["mat-row",""];function rt(t,e){1&t&&r.Vb(0,"tr",ot)}const nt=["/budget/create"];let at=(()=>{class t{constructor(t,e){this.itemService=t,this.proyectoService=e,this.displayedColumns=["codigo","descripcion","unidad","cantidad","precio","parcial","edit","delete"]}ngOnInit(){this.proyectoService.project$.pipe(Object(a.a)(t=>(this.proyecto=t,this.itemService.getItemByProyectoId(t.id)))).subscribe(t=>{this.items=t.model,this.resultsLength=t.totalRegister})}}return t.ngComponentDef=r.Ob({type:t,selectors:[["app-item-list"]],factory:function(e){return new(e||t)(r.Ub(s.a),r.Ub(d.a))},consts:38,vars:4,template:function(t,e){1&t&&(r.bc(0,"mat-card"),r.bc(1,"mat-card-header"),r.bc(2,"mat-card-title"),r.Hc(3," Items "),r.Zb(),r.bc(4,"a",h),r.Hc(5,"CREAR NUEVO ITEM"),r.Zb(),r.Zb(),r.bc(6,"mat-card-content"),r.bc(7,"table",f),r.Yb(8,g),r.Gc(9,V,2,0,"th",y),r.Gc(10,M,2,1,"td",Z),r.Xb(),r.Yb(11,v),r.Gc(12,O,2,0,"th",y),r.Gc(13,k,2,1,"td",Z),r.Xb(),r.Yb(14,w),r.Gc(15,A,2,0,"th",y),r.Gc(16,T,2,1,"td",Z),r.Xb(),r.Yb(17,C),r.Gc(18,X,2,0,"th",y),r.Gc(19,j,2,1,"td",Z),r.Xb(),r.Yb(20,I),r.Gc(21,Y,2,0,"th",y),r.Gc(22,N,3,3,"td",Z),r.Xb(),r.Yb(23,D),r.Gc(24,$,2,0,"th",y),r.Gc(25,B,3,3,"td",Z),r.Xb(),r.Yb(26,S),r.Gc(27,J,1,0,"th",y),r.Gc(28,L,1,0,"th",y),r.Gc(29,_,4,3,"td",Z),r.Gc(30,F,1,0,"td",R),r.Xb(),r.Yb(31,G),r.Gc(32,K,1,0,"th",y),r.Gc(33,Q,2,0,"th",y),r.Gc(34,tt,4,0,"td",Z),r.Gc(35,et,1,0,"td",R),r.Xb(),r.Gc(36,it,1,0,"tr",H),r.Gc(37,rt,1,0,"tr",P),r.Zb(),r.Zb(),r.Zb()),2&t&&(r.yc(4),r.rc("routerLink",nt),r.yc(7),r.rc("dataSource",e.items),r.yc(36),r.rc("matHeaderRowDef",e.displayedColumns),r.yc(37),r.rc("matRowDefColumns",e.displayedColumns))},directives:[l.a,l.d,l.f,b.a,u.c,l.c,m.n,m.c,m.i,m.b,m.e,m.k,m.m,m.h,m.a,p.a,m.d,b.b,m.j,m.l],pipes:[n.d],styles:[""]}),t})();var st=c("Xv+k"),dt=c("rOzB"),lt=c("a3vc"),bt=c("SnT8"),ut=c("IRfi"),mt=c("A2Vd"),pt=c("sxj9"),ht=c("GkDt");const ft=[3,"formGroup"],gt=["cols","5","rowHeight","600px",1,"full-width"],yt=[3,"colspan","rowspan"],Zt=[1,"full-width","full-height"],vt=[1,"row"],wt=[1,"col"],Ct=[1,"full-width"],It=["placeholder","Codigo","formControlName","codigo","matInput","","type","text"],Dt=["placeholder","Unidad","formControlName","unidad","matInput","","type","text"],St=["placeholder","Cantidad","formControlName","cantidad","matInput","","type","number"],Rt=["placeholder","Descripcion","formControlName","descripcion","matInput","","type","text","matTextareaAutosize","","matAutosizeMinRows","3","matAutosizeMaxRows","6"],Gt=[1,"row","buttons"],Ht=["mat-raised-button","","color","primary",1,"full-width",3,"click"],Pt=[3,"isProcesing","itemId","save"],Ut=[3,"recursoSelected",4,"ngIf"],Vt=[3,"proyecto","analisisSelected",4,"ngIf"],xt=[3,"recursoSelected"];function Mt(t,e){if(1&t){const t=r.cc();r.bc(0,"app-table-resource",xt),r.hc("recursoSelected",(function(e){return r.wc(t),r.mc().addResource(e)})),r.Zb()}}const Ot=[3,"proyecto","analisisSelected"];function kt(t,e){if(1&t){const t=r.cc();r.bc(0,"app-table-analysis",Ot),r.hc("analisisSelected",(function(e){return r.wc(t),r.mc().addAnalysis(e)})),r.Zb()}if(2&t){const t=r.mc();r.rc("proyecto",t.proyecto)}}let At=(()=>{class t{constructor(t,e,c,i,o,r){this.formBuilder=t,this.recursoBasicoService=e,this.proyectoService=c,this.itemService=i,this.detalleService=o,this.route=r,this.item=null,this.isRecursoSelected=!1,this.isProcesing=!1,this.id=0,this.buildForm()}ngOnInit(){this.proyectoService.project$.subscribe(t=>{this.proyecto=t}),this.route.params.pipe(Object(a.a)(t=>(this.id=t.id?Number(t.id):0,console.log(this.id),this.itemService.getItemById(this.id)))).subscribe(t=>{this.item=t.model,console.log(t),this.buildForm()})}buildForm(){this.form=this.formBuilder.group({codigo:[this.item?this.item.codigo:"",[i.o.required]],descripcion:[this.item?this.item.descripcion:"",[i.o.required]],unidad:[this.item?this.item.unidad:"",[i.o.required]],cantidad:[this.item?this.item.cantidad:"",[i.o.required]]})}createItem(t){this.isProcesing=!0,console.log(t);const e=t?this.getValorUnitario(t):0,c={id:Number(this.id),codigo:this.form.get("codigo").value,descripcion:this.form.get("descripcion").value,unidad:this.form.get("unidad").value,cantidad:this.form.get("cantidad").value,aporte:0,detalles:null,proyectoId:this.proyecto.id,valorUnitario:Math.round(e)};0===this.id?this.postItem(c,t):this.putItem(c,t)}getValorUnitario(t){return t.map(t=>t.subTotal).reduce((t,e)=>t+e,0)}addResource(t){console.log(t),this.tableComponent.addRow({id:0,itemId:this.item?this.item.id:0,codigo:t.codigo,descripcion:t.descripcion,unidad:t.unidad,precio:t.precio,rendimiento:1,desperdicio:0,detalleDe:"recurso",subTotal:t.precio},!0)}addAnalysis(t){this.tableComponent.addRow({id:0,itemId:this.item?this.item.id:0,codigo:t.codigo,descripcion:t.descripcion,unidad:t.unidad,precio:t.valorUnitario,rendimiento:1,desperdicio:0,detalleDe:"analisis",subTotal:t.valorUnitario},!0)}showResourceTable(){this.isRecursoSelected=!0,console.log(this.isRecursoSelected)}showAnalysisTable(){this.isRecursoSelected=!1,console.log(this.isRecursoSelected)}postItem(t,e){this.itemService.postItem(t).subscribe(t=>{console.log(t),e.forEach(e=>{this.postDetalle(e,t.model.id)})},t=>{console.error(t.error),this.isProcesing=!1})}putItem(t,e){this.itemService.putItem(t).subscribe(e=>{console.log(e),t.id=this.id},t=>{console.error(t.error),this.isProcesing=!1}),e&&e.forEach(t=>{0===t.id?this.postDetalle(t,this.id):this.putDetalle(t)})}postDetalle(t,e){t.itemId=e,this.detalleService.postDetalle(t).subscribe(t=>{console.log(t),this.isProcesing=!1},t=>{console.log(t.error),this.isProcesing=!1})}putDetalle(t){this.detalleService.putDetalle(t).subscribe(t=>{console.log(t),this.isProcesing=!1},t=>{console.log(t.error),this.isProcesing=!1})}}return t.ngComponentDef=r.Ob({type:t,selectors:[["app-budget"]],factory:function(e){return new(e||t)(r.Ub(i.c),r.Ub(dt.a),r.Ub(d.a),r.Ub(s.a),r.Ub(lt.a),r.Ub(u.a))},viewQuery:function(t,e){var c;1&t&&r.Lc(st.a,!0),2&t&&r.tc(c=r.jc())&&(e.tableComponent=c.first)},consts:42,vars:9,template:function(t,e){1&t&&(r.bc(0,"form",ft),r.bc(1,"mat-grid-list",gt),r.bc(2,"mat-grid-tile",yt),r.bc(3,"mat-card",Zt),r.bc(4,"mat-card-header"),r.bc(5,"mat-card-title"),r.Hc(6," Item "),r.Zb(),r.Zb(),r.bc(7,"mat-card-content"),r.bc(8,"div",vt),r.bc(9,"div",wt),r.bc(10,"mat-form-field",Ct),r.Vb(11,"input",It),r.Zb(),r.Zb(),r.bc(12,"div",wt),r.bc(13,"mat-form-field",Ct),r.Vb(14,"input",Dt),r.Zb(),r.Zb(),r.Zb(),r.bc(15,"div",vt),r.bc(16,"div",wt),r.bc(17,"mat-form-field",Ct),r.Vb(18,"input",St),r.Zb(),r.Zb(),r.Vb(19,"div",wt),r.Zb(),r.bc(20,"div",vt),r.bc(21,"div",wt),r.bc(22,"mat-form-field",Ct),r.Vb(23,"textarea",Rt),r.Zb(),r.Zb(),r.Zb(),r.bc(24,"div",Gt),r.bc(25,"div",wt),r.bc(26,"a",Ht),r.hc("click",(function(t){return e.showResourceTable()})),r.bc(27,"mat-icon"),r.Hc(28,"add"),r.Zb(),r.Hc(29," Agregar Recurso B\xe1scico "),r.Zb(),r.Zb(),r.bc(30,"div",wt),r.bc(31,"a",Ht),r.hc("click",(function(t){return e.showAnalysisTable()})),r.bc(32,"mat-icon"),r.Hc(33,"add"),r.Zb(),r.Hc(34," Agregar An\xe1lisis Unitario "),r.Zb(),r.Zb(),r.Zb(),r.bc(35,"div",vt),r.bc(36,"div",wt),r.bc(37,"app-table",Pt),r.hc("save",(function(t){return e.createItem(t)})),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.bc(38,"mat-grid-tile",yt),r.bc(39,"div",Zt),r.Gc(40,Mt,1,0,"app-table-resource",Ut),r.Gc(41,kt,1,1,"app-table-analysis",Vt),r.Zb(),r.Zb(),r.Zb(),r.Zb()),2&t&&(r.rc("formGroup",e.form),r.yc(2),r.rc("colspan",3)("rowspan",2),r.yc(37),r.rc("isProcesing",e.isProcesing)("itemId",e.id),r.yc(38),r.rc("colspan",2)("rowspan",2),r.yc(40),r.rc("ngIf",e.isRecursoSelected),r.yc(41),r.rc("ngIf",!e.isRecursoSelected&&e.proyecto))},directives:[i.p,i.k,i.e,bt.a,bt.c,l.a,l.d,l.f,l.c,ut.b,i.a,mt.b,i.j,i.d,i.m,mt.d,b.a,p.a,st.a,n.l,pt.a,ht.a],styles:[".full-width[_ngcontent-%COMP%]{width:100%}.full-height[_ngcontent-%COMP%]{height:100%}.row[_ngcontent-%COMP%]{display:flex;flex-direction:row}.col[_ngcontent-%COMP%]{flex:1;margin-right:20px}.col[_ngcontent-%COMP%]:last-child{margin-right:0}.buttons[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:20px}"]}),t})();const Tt=[{path:"",component:at},{path:"create",component:At},{path:"edit/:id",component:At}];let Xt=(()=>{class t{}return t.ngModuleDef=r.Sb({type:t}),t.ngInjectorDef=r.Rb({factory:function(e){return new(e||t)},imports:[[u.d.forChild(Tt)],u.d]}),t})();u.d.forChild(Tt);var jt=c("PCNd");c.d(e,"BudgetModule",(function(){return Yt}));let Yt=(()=>{class t{}return t.ngModuleDef=r.Sb({type:t}),t.ngInjectorDef=r.Rb({factory:function(e){return new(e||t)},imports:[[n.c,jt.a,o.a,i.n,Xt]]}),t})()}}]);