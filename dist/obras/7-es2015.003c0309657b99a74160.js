(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"462b":function(t,i,e){"use strict";e.r(i);var o=e("tyNb"),c=e("hctd"),n=e("3Pt+"),s=e("fXoL"),r=e("ofXK"),a=e("eIep"),l=e("wpiq"),d=e("yp1H"),b=e("MSSf"),u=e("Xlwt"),p=e("tmTa"),m=e("TY1r");const h=["mat-button","","color","primary",3,"routerLink"],f=["mat-table","",1,"mat-elevation-z8",3,"dataSource"],g=["matColumnDef","codigo"],y=["mat-header-cell","",4,"matHeaderCellDef"],Z=["mat-cell","",4,"matCellDef"],v=["matColumnDef","descripcion"],U=["matColumnDef","unidad"],w=["matColumnDef","precio"],C=["matColumnDef","edit"],D=["mat-footer-cell","",4,"matFooterCellDef"],S=["matColumnDef","delete"],P=["mat-header-row","",4,"matHeaderRowDef"],A=["mat-row","",4,"matRowDef","matRowDefColumns"],G=["mat-header-cell",""];function I(t,i){1&t&&(s.bc(0,"th",G),s.Hc(1," C\xf3digo "),s.Zb())}const H=["mat-cell",""];function R(t,i){if(1&t&&(s.bc(0,"td",H),s.Hc(1),s.Zb()),2&t){const t=i.$implicit;s.yc(1),s.Jc(" ",t.codigo," ")}}function x(t,i){1&t&&(s.bc(0,"th",G),s.Hc(1," Descripci\xf3n "),s.Zb())}function O(t,i){if(1&t&&(s.bc(0,"td",H),s.Hc(1),s.Zb()),2&t){const t=i.$implicit;s.yc(1),s.Jc(" ",t.descripcion," ")}}function M(t,i){1&t&&(s.bc(0,"th",G),s.Hc(1," Unidad "),s.Zb())}function V(t,i){if(1&t&&(s.bc(0,"td",H),s.Hc(1),s.Zb()),2&t){const t=i.$implicit;s.yc(1),s.Jc(" ",t.unidad," ")}}function j(t,i){1&t&&(s.bc(0,"th",G),s.Hc(1," Precio Unidad "),s.Zb())}function N(t,i){if(1&t&&(s.bc(0,"td",H),s.Hc(1),s.nc(2,"currency"),s.Zb()),2&t){const t=i.$implicit;s.yc(1),s.Jc(" ",s.oc(2,1,t.valorUnitario)," ")}}function X(t,i){1&t&&s.Vb(0,"th",G)}function k(t,i){1&t&&s.Vb(0,"th",G)}const L=["mat-icon-button","",3,"routerLink"],T=function(t){return["/analysis/edit",t]};function Y(t,i){if(1&t&&(s.bc(0,"td",H),s.bc(1,"a",L),s.bc(2,"mat-icon"),s.Hc(3,"edit"),s.Zb(),s.Zb(),s.Zb()),2&t){const t=i.$implicit;s.yc(1),s.rc("routerLink",s.sc(1,T,t.id))}}const $=["mat-footer-cell",""];function J(t,i){1&t&&s.Vb(0,"td",$)}function _(t,i){1&t&&s.Vb(0,"th",G)}function E(t,i){1&t&&(s.bc(0,"th",G),s.Hc(1," Porcentaje "),s.Zb())}const q=["mat-icon-button","","aria-label","Example icon-button with a heart icon"];function z(t,i){1&t&&(s.bc(0,"td",H),s.bc(1,"button",q),s.bc(2,"mat-icon"),s.Hc(3,"delete"),s.Zb(),s.Zb(),s.Zb())}function B(t,i){1&t&&s.Vb(0,"td",$)}const F=["mat-header-row",""];function K(t,i){1&t&&s.Vb(0,"tr",F)}const Q=["mat-row",""];function W(t,i){1&t&&s.Vb(0,"tr",Q)}const tt=["/analysis/create"];let it=(()=>{class t{constructor(t,i){this.analisisUnitarioService=t,this.proyectoService=i,this.displayedColumns=["codigo","descripcion","unidad","precio","edit","delete"]}ngOnInit(){this.proyectoService.project$.pipe(Object(a.a)(t=>(this.proyecto=t,this.analisisUnitarioService.getAnalisisUnitarioByProyectoId(t.id)))).subscribe(t=>{this.analisisUnitarios=t.model,this.resultsLength=t.totalRegister})}}return t.ngComponentDef=s.Ob({type:t,selectors:[["app-analysis-list"]],factory:function(i){return new(i||t)(s.Ub(l.a),s.Ub(d.a))},consts:32,vars:4,template:function(t,i){1&t&&(s.bc(0,"mat-card"),s.bc(1,"mat-card-header"),s.bc(2,"mat-card-title"),s.Hc(3," An\xe1lisis Unitarios "),s.Zb(),s.bc(4,"a",h),s.Hc(5,"CREAR NUEVO AN\xc1LISIS UNITARIO"),s.Zb(),s.Zb(),s.bc(6,"mat-card-content"),s.bc(7,"table",f),s.Yb(8,g),s.Gc(9,I,2,0,"th",y),s.Gc(10,R,2,1,"td",Z),s.Xb(),s.Yb(11,v),s.Gc(12,x,2,0,"th",y),s.Gc(13,O,2,1,"td",Z),s.Xb(),s.Yb(14,U),s.Gc(15,M,2,0,"th",y),s.Gc(16,V,2,1,"td",Z),s.Xb(),s.Yb(17,w),s.Gc(18,j,2,0,"th",y),s.Gc(19,N,3,3,"td",Z),s.Xb(),s.Yb(20,C),s.Gc(21,X,1,0,"th",y),s.Gc(22,k,1,0,"th",y),s.Gc(23,Y,4,3,"td",Z),s.Gc(24,J,1,0,"td",D),s.Xb(),s.Yb(25,S),s.Gc(26,_,1,0,"th",y),s.Gc(27,E,2,0,"th",y),s.Gc(28,z,4,0,"td",Z),s.Gc(29,B,1,0,"td",D),s.Xb(),s.Gc(30,K,1,0,"tr",P),s.Gc(31,W,1,0,"tr",A),s.Zb(),s.Zb(),s.Zb()),2&t&&(s.yc(4),s.rc("routerLink",tt),s.yc(7),s.rc("dataSource",i.analisisUnitarios),s.yc(30),s.rc("matHeaderRowDef",i.displayedColumns),s.yc(31),s.rc("matRowDefColumns",i.displayedColumns))},directives:[b.a,b.d,b.f,u.a,o.c,b.c,p.n,p.c,p.i,p.b,p.e,p.k,p.m,p.h,p.a,m.a,p.d,u.b,p.j,p.l],pipes:[r.d],styles:[""]}),t})();var et=e("Xv+k"),ot=e("a3vc"),ct=e("SnT8"),nt=e("IRfi"),st=e("A2Vd"),rt=e("sxj9");const at=[3,"formGroup"],lt=["cols","7","rowHeight","600px"],dt=[3,"colspan","rowspan"],bt=[1,"full-width","full-height"],ut=[1,"row"],pt=[1,"col"],mt=[1,"full-width"],ht=["placeholder","Codigo","formControlName","codigo","matInput","","type","text"],ft=["placeholder","Unidad","formControlName","unidad","matInput","","type","text"],gt=["placeholder","Descripcion","formControlName","descripcion","matInput","","type","text","matTextareaAutosize","","matAutosizeMinRows","3","matAutosizeMaxRows","6"],yt=[3,"isProcesing","analisisId","save"],Zt=[3,"recursoSelected"];let vt=(()=>{class t{constructor(t,i,e,o,c){this.formBuilder=t,this.proyectoService=i,this.analisisUnitarioService=e,this.detalleService=o,this.route=c,this.id=0,this.isProcesing=!1,this.buildForm()}ngOnInit(){this.proyectoService.project$.subscribe(t=>{this.proyecto=t}),this.route.params.pipe(Object(a.a)(t=>(this.id=t.id?Number(t.id):0,console.log(this.id),this.analisisUnitarioService.getAnalisisUnitarioById(this.id)))).subscribe(t=>{this.analisisUnitario=t.model,console.log(t),this.buildForm()})}buildForm(){this.form=this.formBuilder.group({codigo:[this.analisisUnitario?this.analisisUnitario.codigo:"",[n.o.required]],descripcion:[this.analisisUnitario?this.analisisUnitario.descripcion:"",[n.o.required]],unidad:[this.analisisUnitario?this.analisisUnitario.unidad:"",[n.o.required]]})}addResource(t){console.log(t),this.tableComponent.addRow({id:0,analisisUnitarioId:this.analisisUnitario?this.id:0,codigo:t.codigo,descripcion:t.descripcion,unidad:t.unidad,precio:t.precio,rendimiento:1,desperdicio:0,detalleDe:"recurso",subTotal:t.precio},!0)}createAnalisis(t){this.isProcesing=!0,console.log(t);const i=t.map(t=>t.subTotal).reduce((t,i)=>t+i,0),e={id:Number(this.id),codigo:this.form.get("codigo").value,descripcion:this.form.get("descripcion").value,unidad:this.form.get("unidad").value,detalles:null,proyectoId:this.proyecto.id,valorUnitario:Math.round(i)};console.log(e),0===this.id?this.postAnalysis(e,t):this.putAnalysis(e,t)}postAnalysis(t,i){this.analisisUnitarioService.postAnalisisUnitario(t).subscribe(t=>{console.log(t),i.forEach(i=>{this.postDetalle(i,t.model.id)})},t=>{console.error(t.error),this.isProcesing=!1})}putAnalysis(t,i){this.analisisUnitarioService.putAnalisisUnitario(t,this.id).subscribe(i=>{console.log(i),t.id=this.id},t=>{console.error(t.error),this.isProcesing=!1}),null!==i&&i.forEach(t=>{0===t.id?this.postDetalle(t,this.id):this.putDetalle(t)})}postDetalle(t,i){t.analisisUnitarioId=i,this.detalleService.postDetalle(t).subscribe(t=>{console.log(t),this.isProcesing=!1},t=>{console.log(t.error),this.isProcesing=!1})}putDetalle(t){this.detalleService.putDetalle(t).subscribe(t=>{console.log(t),this.isProcesing=!1},t=>{console.error(t.error),this.isProcesing=!1})}}return t.ngComponentDef=s.Ob({type:t,selectors:[["app-analysis"]],factory:function(i){return new(i||t)(s.Ub(n.c),s.Ub(d.a),s.Ub(l.a),s.Ub(ot.a),s.Ub(o.a))},viewQuery:function(t,i){var e;1&t&&s.Lc(et.a,!0),2&t&&s.tc(e=s.jc())&&(i.tableComponent=e.first)},consts:25,vars:7,template:function(t,i){1&t&&(s.bc(0,"form",at),s.bc(1,"mat-grid-list",lt),s.bc(2,"mat-grid-tile",dt),s.bc(3,"mat-card",bt),s.bc(4,"mat-card-header"),s.bc(5,"mat-card-title"),s.Hc(6," An\xe1lisis Unitario "),s.Zb(),s.Zb(),s.bc(7,"mat-card-content"),s.bc(8,"div",ut),s.bc(9,"div",pt),s.bc(10,"mat-form-field",mt),s.Vb(11,"input",ht),s.Zb(),s.Zb(),s.bc(12,"div",pt),s.bc(13,"mat-form-field",mt),s.Vb(14,"input",ft),s.Zb(),s.Zb(),s.Zb(),s.bc(15,"div",ut),s.bc(16,"div",pt),s.bc(17,"mat-form-field",mt),s.Vb(18,"textarea",gt),s.Zb(),s.Zb(),s.Zb(),s.bc(19,"div",ut),s.bc(20,"div",pt),s.bc(21,"app-table",yt),s.hc("save",(function(t){return i.createAnalisis(t)})),s.Zb(),s.Zb(),s.Zb(),s.Zb(),s.Zb(),s.Zb(),s.bc(22,"mat-grid-tile",dt),s.bc(23,"div",bt),s.bc(24,"app-table-resource",Zt),s.hc("recursoSelected",(function(t){return i.addResource(t)})),s.Zb(),s.Zb(),s.Zb(),s.Zb(),s.Zb()),2&t&&(s.rc("formGroup",i.form),s.yc(2),s.rc("colspan",4)("rowspan",2),s.yc(21),s.rc("isProcesing",i.isProcesing)("analisisId",i.id),s.yc(22),s.rc("colspan",3)("rowspan",2))},directives:[n.p,n.k,n.e,ct.a,ct.c,b.a,b.d,b.f,b.c,nt.b,n.a,st.b,n.j,n.d,st.d,et.a,rt.a],styles:[".full-width[_ngcontent-%COMP%]{width:100%}.full-height[_ngcontent-%COMP%]{height:100%}.row[_ngcontent-%COMP%]{display:flex;flex-direction:row}.col[_ngcontent-%COMP%]{flex:1;margin-right:20px}.col[_ngcontent-%COMP%]:last-child{margin-right:0}.buttons[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:20px}"]}),t})();const Ut=[{path:"",component:it},{path:"create",component:vt},{path:"edit/:id",component:vt}];let wt=(()=>{class t{}return t.ngModuleDef=s.Sb({type:t}),t.ngInjectorDef=s.Rb({factory:function(i){return new(i||t)},imports:[[o.d.forChild(Ut)],o.d]}),t})();o.d.forChild(Ut);var Ct=e("PCNd");e.d(i,"AnalysisModule",(function(){return Dt}));let Dt=(()=>{class t{}return t.ngModuleDef=s.Sb({type:t}),t.ngInjectorDef=s.Rb({factory:function(i){return new(i||t)},imports:[[r.c,wt,c.a,Ct.a,n.n,o.d]]}),t})()}}]);