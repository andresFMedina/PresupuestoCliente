(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"462b":function(i,t,o){"use strict";o.r(t);var e=o("tyNb"),c=o("hctd"),n=o("3Pt+"),r=o("fXoL"),s=o("ofXK"),a=o("eIep"),l=o("wpiq"),d=o("yp1H"),b=o("MSSf"),u=o("Xlwt"),p=o("tmTa"),m=o("TY1r");const h=["mat-button","","color","primary",3,"routerLink"],f=["mat-table","",1,"mat-elevation-z8",3,"dataSource"],g=["matColumnDef","codigo"],y=["mat-header-cell","",4,"matHeaderCellDef"],Z=["mat-cell","",4,"matCellDef"],v=["matColumnDef","descripcion"],U=["matColumnDef","unidad"],w=["matColumnDef","precio"],C=["matColumnDef","edit"],D=["mat-footer-cell","",4,"matFooterCellDef"],S=["matColumnDef","delete"],G=["mat-header-row","",4,"matHeaderRowDef"],P=["mat-row","",4,"matRowDef","matRowDefColumns"],H=["mat-header-cell",""];function A(i,t){1&i&&(r.bc(0,"th",H),r.Hc(1," C\xf3digo "),r.Zb())}const I=["mat-cell",""];function R(i,t){if(1&i&&(r.bc(0,"td",I),r.Hc(1),r.Zb()),2&i){const i=t.$implicit;r.yc(1),r.Jc(" ",i.codigo," ")}}function O(i,t){1&i&&(r.bc(0,"th",H),r.Hc(1," Descripci\xf3n "),r.Zb())}function x(i,t){if(1&i&&(r.bc(0,"td",I),r.Hc(1),r.Zb()),2&i){const i=t.$implicit;r.yc(1),r.Jc(" ",i.descripcion," ")}}function M(i,t){1&i&&(r.bc(0,"th",H),r.Hc(1," Unidad "),r.Zb())}function j(i,t){if(1&i&&(r.bc(0,"td",I),r.Hc(1),r.Zb()),2&i){const i=t.$implicit;r.yc(1),r.Jc(" ",i.unidad," ")}}function V(i,t){1&i&&(r.bc(0,"th",H),r.Hc(1," Precio Unidad "),r.Zb())}function k(i,t){if(1&i&&(r.bc(0,"td",I),r.Hc(1),r.nc(2,"currency"),r.Zb()),2&i){const i=t.$implicit;r.yc(1),r.Jc(" ",r.oc(2,1,i.valorUnitario)," ")}}function N(i,t){1&i&&r.Vb(0,"th",H)}function X(i,t){1&i&&r.Vb(0,"th",H)}const L=["mat-icon-button","",3,"routerLink"],$=function(i){return["/analysis/edit",i]};function F(i,t){if(1&i&&(r.bc(0,"td",I),r.bc(1,"a",L),r.bc(2,"mat-icon"),r.Hc(3,"edit"),r.Zb(),r.Zb(),r.Zb()),2&i){const i=t.$implicit;r.yc(1),r.rc("routerLink",r.sc(1,$,i.id))}}const J=["mat-footer-cell",""];function T(i,t){1&i&&r.Vb(0,"td",J)}function Y(i,t){1&i&&r.Vb(0,"th",H)}function _(i,t){1&i&&(r.bc(0,"th",H),r.Hc(1," Porcentaje "),r.Zb())}const q=["mat-icon-button","","aria-label","Example icon-button with a heart icon"];function E(i,t){1&i&&(r.bc(0,"td",I),r.bc(1,"button",q),r.bc(2,"mat-icon"),r.Hc(3,"delete"),r.Zb(),r.Zb(),r.Zb())}function z(i,t){1&i&&r.Vb(0,"td",J)}const B=["mat-header-row",""];function K(i,t){1&i&&r.Vb(0,"tr",B)}const Q=["mat-row",""];function W(i,t){1&i&&r.Vb(0,"tr",Q)}const ii=["/analysis/create"];let ti=(()=>{class i{constructor(i,t){this.analisisUnitarioService=i,this.proyectoService=t,this.displayedColumns=["codigo","descripcion","unidad","precio","edit","delete"]}ngOnInit(){this.proyectoService.project$.pipe(Object(a.a)(i=>(this.proyecto=i,this.analisisUnitarioService.getAnalisisUnitarioByProyectoId(i.id)))).subscribe(i=>{this.analisisUnitarios=i.model,this.resultsLength=i.totalRegister})}}return i.ngComponentDef=r.Ob({type:i,selectors:[["app-analysis-list"]],factory:function(t){return new(t||i)(r.Ub(l.a),r.Ub(d.a))},consts:32,vars:4,template:function(i,t){1&i&&(r.bc(0,"mat-card"),r.bc(1,"mat-card-header"),r.bc(2,"mat-card-title"),r.Hc(3," An\xe1lisis Unitarios "),r.Zb(),r.bc(4,"a",h),r.Hc(5,"CREAR NUEVO AN\xc1LISIS UNITARIO"),r.Zb(),r.Zb(),r.bc(6,"mat-card-content"),r.bc(7,"table",f),r.Yb(8,g),r.Gc(9,A,2,0,"th",y),r.Gc(10,R,2,1,"td",Z),r.Xb(),r.Yb(11,v),r.Gc(12,O,2,0,"th",y),r.Gc(13,x,2,1,"td",Z),r.Xb(),r.Yb(14,U),r.Gc(15,M,2,0,"th",y),r.Gc(16,j,2,1,"td",Z),r.Xb(),r.Yb(17,w),r.Gc(18,V,2,0,"th",y),r.Gc(19,k,3,3,"td",Z),r.Xb(),r.Yb(20,C),r.Gc(21,N,1,0,"th",y),r.Gc(22,X,1,0,"th",y),r.Gc(23,F,4,3,"td",Z),r.Gc(24,T,1,0,"td",D),r.Xb(),r.Yb(25,S),r.Gc(26,Y,1,0,"th",y),r.Gc(27,_,2,0,"th",y),r.Gc(28,E,4,0,"td",Z),r.Gc(29,z,1,0,"td",D),r.Xb(),r.Gc(30,K,1,0,"tr",G),r.Gc(31,W,1,0,"tr",P),r.Zb(),r.Zb(),r.Zb()),2&i&&(r.yc(4),r.rc("routerLink",ii),r.yc(7),r.rc("dataSource",t.analisisUnitarios),r.yc(30),r.rc("matHeaderRowDef",t.displayedColumns),r.yc(31),r.rc("matRowDefColumns",t.displayedColumns))},directives:[b.a,b.d,b.f,u.a,e.c,b.c,p.n,p.c,p.i,p.b,p.e,p.k,p.m,p.h,p.a,m.a,p.d,u.b,p.j,p.l],pipes:[s.d],styles:[""]}),i})();var oi=o("g1w/"),ei=o("Xv+k"),ci=o("a3vc"),ni=o("SnT8"),ri=o("IRfi"),si=o("A2Vd"),ai=o("2+6u"),li=o("sxj9"),di=o("j14s");const bi=[3,"formGroup"],ui=["cols","7","rowHeight","600px"],pi=[3,"colspan","rowspan"],mi=[1,"full-width","full-height"],hi=[1,"row"],fi=[1,"col"],gi=[1,"full-width"],yi=["placeholder","Codigo","formControlName","codigo","matInput","","type","text"],Zi=["formControlName","grupo"],vi=[3,"value",4,"ngFor","ngForOf"],Ui=["placeholder","Descripcion","formControlName","descripcion","matInput","","type","text","matTextareaAutosize","","matAutosizeMinRows","3","matAutosizeMaxRows","6"],wi=[3,"isProcesing","analisisId","save"],Ci=[3,"recursoSelected"],Di=[3,"value"];function Si(i,t){if(1&i&&(r.bc(0,"mat-option",Di),r.Hc(1),r.Zb()),2&i){const i=t.$implicit;r.rc("value",i.codigo),r.yc(1),r.Jc(" ",i.nombre," ")}}let Gi=(()=>{class i{constructor(i,t,o,e,c){this.formBuilder=i,this.proyectoService=t,this.analisisUnitarioService=o,this.detalleService=e,this.route=c,this.id=0,this.isProcesing=!1,this.grupos=oi.a,this.buildForm()}ngOnInit(){this.proyectoService.project$.subscribe(i=>{this.proyecto=i}),this.route.params.pipe(Object(a.a)(i=>(this.id=i.id?Number(i.id):0,console.log(this.id),this.analisisUnitarioService.getAnalisisUnitarioById(this.id)))).subscribe(i=>{this.analisisUnitario=i.model,console.log(i),this.buildForm()})}buildForm(){this.form=this.formBuilder.group({codigo:[this.analisisUnitario?this.analisisUnitario.codigo:"",[n.o.required]],descripcion:[this.analisisUnitario?this.analisisUnitario.descripcion:"",[n.o.required]],unidad:[this.analisisUnitario?this.analisisUnitario.unidad:"",[n.o.required]],grupo:[this.analisisUnitario?this.analisisUnitario.grupo:"",[n.o.required]]})}addResource(i){console.log(i),this.tableComponent.addRow({id:0,analisisUnitarioId:this.analisisUnitario?this.id:0,codigo:i.codigo,descripcion:i.descripcion,unidad:i.unidad,precio:i.precio,rendimiento:1,desperdicio:0,grupo:i.grupo,detalleDe:"recurso",subTotal:i.precio},!0)}createAnalisis(i){this.isProcesing=!0,console.log(i);const t=i.map(i=>i.subTotal).reduce((i,t)=>i+t,0),o={id:Number(this.id),codigo:this.form.get("codigo").value,descripcion:this.form.get("descripcion").value,unidad:this.form.get("unidad").value,detalles:null,proyectoId:this.proyecto.id,grupo:this.form.get("grupo").value,valorUnitario:Math.round(t)};console.log(o),0===this.id?this.postAnalysis(o,i):this.putAnalysis(o,i)}postAnalysis(i,t){this.analisisUnitarioService.postAnalisisUnitario(i).subscribe(i=>{console.log(i),t.forEach(t=>{this.postDetalle(t,i.model.id)})},i=>{console.error(i.error),this.isProcesing=!1})}putAnalysis(i,t){this.analisisUnitarioService.putAnalisisUnitario(i,this.id).subscribe(t=>{console.log(t),i.id=this.id},i=>{console.error(i.error),this.isProcesing=!1}),null!==t&&t.forEach(i=>{0===i.id?this.postDetalle(i,this.id):this.putDetalle(i)})}postDetalle(i,t){i.analisisUnitarioId=t,this.detalleService.postDetalle(i).subscribe(i=>{console.log(i),this.isProcesing=!1},i=>{console.log(i.error),this.isProcesing=!1})}putDetalle(i){this.detalleService.putDetalle(i).subscribe(i=>{console.log(i),this.isProcesing=!1},i=>{console.error(i.error),this.isProcesing=!1})}}return i.ngComponentDef=r.Ob({type:i,selectors:[["app-analysis"]],factory:function(t){return new(t||i)(r.Ub(n.c),r.Ub(d.a),r.Ub(l.a),r.Ub(ci.a),r.Ub(e.a))},viewQuery:function(i,t){var o;1&i&&r.Lc(ei.a,!0),2&i&&r.tc(o=r.jc())&&(t.tableComponent=o.first)},consts:32,vars:8,template:function(i,t){1&i&&(r.bc(0,"form",bi),r.bc(1,"mat-grid-list",ui),r.bc(2,"mat-grid-tile",pi),r.bc(3,"mat-card",mi),r.bc(4,"mat-card-header"),r.bc(5,"mat-card-title"),r.Hc(6," An\xe1lisis Unitario "),r.Zb(),r.Zb(),r.bc(7,"mat-card-content"),r.bc(8,"div",hi),r.bc(9,"div",fi),r.bc(10,"mat-form-field",gi),r.Vb(11,"input",yi),r.Zb(),r.Zb(),r.Zb(),r.bc(12,"div",hi),r.bc(13,"div",fi),r.bc(14,"mat-form-field",gi),r.Vb(15,"input",yi),r.Zb(),r.Zb(),r.bc(16,"div",fi),r.bc(17,"mat-form-field"),r.bc(18,"mat-label"),r.Hc(19," Grupo "),r.Zb(),r.bc(20,"mat-select",Zi),r.Gc(21,Si,2,2,"mat-option",vi),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.bc(22,"div",hi),r.bc(23,"div",fi),r.bc(24,"mat-form-field",gi),r.Vb(25,"textarea",Ui),r.Zb(),r.Zb(),r.Zb(),r.bc(26,"div",hi),r.bc(27,"div",fi),r.bc(28,"app-table",wi),r.hc("save",(function(i){return t.createAnalisis(i)})),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.bc(29,"mat-grid-tile",pi),r.bc(30,"div",mi),r.bc(31,"app-table-resource",Ci),r.hc("recursoSelected",(function(i){return t.addResource(i)})),r.Zb(),r.Zb(),r.Zb(),r.Zb(),r.Zb()),2&i&&(r.rc("formGroup",t.form),r.yc(2),r.rc("colspan",4)("rowspan",2),r.yc(21),r.rc("ngForOf",t.grupos),r.yc(28),r.rc("isProcesing",t.isProcesing)("analisisId",t.id),r.yc(29),r.rc("colspan",3)("rowspan",2))},directives:[n.p,n.k,n.e,ni.a,ni.c,b.a,b.d,b.f,b.c,ri.b,n.a,si.b,n.j,n.d,ri.e,ai.a,s.k,si.d,ei.a,li.a,di.l],styles:[".full-width[_ngcontent-%COMP%]{width:100%}.full-height[_ngcontent-%COMP%]{height:100%}.row[_ngcontent-%COMP%]{display:flex;flex-direction:row}.col[_ngcontent-%COMP%]{flex:1;margin-right:20px}.col[_ngcontent-%COMP%]:last-child{margin-right:0}.buttons[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:20px}"]}),i})();const Pi=[{path:"",component:ti},{path:"create",component:Gi},{path:"edit/:id",component:Gi}];let Hi=(()=>{class i{}return i.ngModuleDef=r.Sb({type:i}),i.ngInjectorDef=r.Rb({factory:function(t){return new(t||i)},imports:[[e.d.forChild(Pi)],e.d]}),i})();e.d.forChild(Pi);var Ai=o("PCNd");o.d(t,"AnalysisModule",(function(){return Ii}));let Ii=(()=>{class i{}return i.ngModuleDef=r.Sb({type:i}),i.ngInjectorDef=r.Rb({factory:function(t){return new(t||i)},imports:[[s.c,Hi,c.a,Ai.a,n.n,e.d]]}),i})()}}]);