{"version":3,"sources":["./src/app/aiu/aiu-routing.module.ts","./src/app/aiu/aiu.module.ts","./src/app/aiu/components/aiu/aiu.component.ts","./src/app/aiu/components/aiu/aiu.component.html","./src/app/aiu/components/table-aiu/table-aiu.component.ts","./src/app/aiu/components/table-aiu/table-aiu.component.html"],"names":[],"mappings":"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","file":"aiu-aiu-module-es2015.js","sourcesContent":["import { AiuComponent } from './components/aiu/aiu.component';\nimport { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: AiuComponent\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class AiuRoutingModule { }\n","import { SharedModule } from './../shared/shared.module';\nimport { MaterialModule } from './../material/material.module';\nimport { ReactiveFormsModule } from '@angular/forms';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { AiuRoutingModule } from './aiu-routing.module';\nimport { AiuComponent } from './components/aiu/aiu.component';\nimport { TableAiuComponent } from './components/table-aiu/table-aiu.component';\n\n\n\n@NgModule({\n  declarations: [AiuComponent, TableAiuComponent],\n  imports: [\n    CommonModule,\n    AiuRoutingModule,\n    SharedModule,\n    ReactiveFormsModule,\n    MaterialModule\n  ]\n})\nexport class AiuModule { }\n","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-aiu',\n  templateUrl: './aiu.component.html',\n  styleUrls: ['./aiu.component.scss']\n})\nexport class AiuComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","<mat-grid-list cols=\"3\" rowHeight=\"200px\">\n    <mat-grid-tile [colspan]=\"2\" [rowspan]=\"2\">\n        <mat-card class=\"full-width full-height\">\n            <mat-card-header>\n                <mat-card-title>\n                    Componentes de Costos Indirecto\n                </mat-card-title>\n            </mat-card-header>\n            <mat-card-content>\n                <app-table-aiu></app-table-aiu>\n            </mat-card-content>\n        </mat-card>\n    </mat-grid-tile>\n    <mat-grid-tile [colspan]=\"1\" [rowspan]=\"2\">\n            <mat-card class=\"full-width full-height\">\n            <mat-card-header>\n                <mat-card-title>\n                    Costos\n                </mat-card-title>\n            </mat-card-header>\n            <mat-card-content>\n                <app-table-cost></app-table-cost>\n            </mat-card-content>\n        </mat-card>\n    </mat-grid-tile>\n</mat-grid-list>","import { Proyecto } from './../../../core/models/proyecto.model';\nimport { CostoIndirectoService } from './../../../core/services/costo-indirecto/costo-indirecto.service';\nimport { ProyectoService } from './../../../core/services/proyecto/proyecto.service';\nimport { CostoIndirecto } from './../../../core/models/costo-indirecto.model';\nimport { FormGroup, FormBuilder, FormArray, Validators, AbstractControl } from '@angular/forms';\nimport { Component, OnInit } from '@angular/core';\nimport { BehaviorSubject } from 'rxjs';\nimport { switchMap } from 'rxjs/operators';\n\n@Component({\n  selector: 'app-table-aiu',\n  templateUrl: './table-aiu.component.html',\n  styleUrls: ['./table-aiu.component.scss']\n})\nexport class TableAiuComponent implements OnInit {\n\n  form: FormGroup;\n  costs: CostoIndirecto[] = [];\n  costsForm: FormArray = this.formBuilder.array([]);\n  dataSource = new BehaviorSubject<AbstractControl[]>([]);\n\n  proyecto: Proyecto;\n  displayedColumns = ['gasto', 'porcentaje', 'add', 'delete'];\n\n  constructor(\n    private formBuilder: FormBuilder,\n    private proyectoService: ProyectoService,\n    private costoIndirectoService: CostoIndirectoService\n  ) { }\n\n  ngOnInit() {\n    this.form = this.formBuilder.group({\n      costs: this.costsForm\n    });\n    this.proyectoService.project$\n      .pipe(\n        switchMap((proyecto) => {\n          this.proyecto = proyecto;\n          return this.costoIndirectoService.getCostoIndirectoByProyectoId(proyecto.id);\n        }))\n      .subscribe(\n        (costosIndirectos) => {\n          this.costs = costosIndirectos;\n          this.costs.forEach((c) => this.addRow(c, false));\n          this.updateView();\n        });\n  }\n\n  getTotalPercent() {\n    return this.costs.map(t => t.porcentaje).reduce((acc, value) => acc + value, 0);\n  }\n  addRow(cost?: CostoIndirecto, noUpdate?: boolean) {\n    const row = this.formBuilder.group({\n      description: [(cost) ? cost.descripcion : null, Validators.required],\n      percent: [(cost) ? cost.porcentaje * 100 : 0, Validators.required],\n    });\n    this.costsForm.push(row);\n    if (!noUpdate) { this.updateView(); }\n  }\n\n\n  updateView() {\n    this.dataSource.next(this.costsForm.controls);\n  }\n\n  deleteRow(index: number) {\n    this.costsForm.removeAt(index);\n    this.updateView();\n  }\n\n  createCost(value, index: number) {\n    console.log(value);\n    // Post para un costo Indirecto\n    if (index >= this.costs.length) {\n      const cost: CostoIndirecto = {\n        id: 0,\n        descripcion: value.description,\n        porcentaje: value.percent / 100,\n        proyectoId: this.proyecto.id\n      };\n      this.costoIndirectoService.postCostoIndirecto(cost).subscribe(\n        (response: CostoIndirecto) => {\n          console.log(response);\n          this.costs.push(response);\n        },\n        (error) => {\n          console.error(error.error);\n        }\n      );\n      console.log(cost);\n      // PUT para un costo indirecto\n    } else {\n      const cost: CostoIndirecto = {\n        id: this.costs[index].id,\n        descripcion: value.description,\n        porcentaje: value.percent / 100,\n        proyectoId: this.proyecto.id\n      };\n      this.costoIndirectoService.putCostoIndirecto(cost).subscribe(\n        (response) => {\n          console.log(response);\n          this.costs[index] = cost;\n        },\n        (error) => {\n          console.error(error.error);\n        }\n      );\n    }\n  }\n\n  isModified(index: number, value): boolean {\n    if (index >= this.costs.length) {\n      return true;\n    }\n\n    if (value.description !== this.costs[index].descripcion ||\n      value.percent / 100 !== this.costs[index].porcentaje) {\n      return true;\n    }\n\n  }\n\n}\n","<form [formGroup]=\"form\">\n    <button mat-raised-button color=\"primary\" type=\"button\" (click)=\"addRow()\">Add row</button>\n    <div>\n        <table mat-table [dataSource]=dataSource class=\"mat-elevation-z8\" formArrayName=\"costs\">\n\n            <!--Columna Gasto-->\n            <ng-container matColumnDef=\"gasto\">\n                <th mat-header-cell *matHeaderCellDef> Gasto </th>\n                <td mat-cell *matCellDef=\"let row; let index = index\" [formGroupName]=\"index\">\n                    <mat-form-field class=\"full-width\">\n                        <input matInput formControlName=\"description\" placeholder=\"DescripciÃ³n\">\n                    </mat-form-field>\n                </td>\n                <td mat-footer-cell *matFooterCellDef> AIU </td>\n            </ng-container>\n\n            <!--Columna Porcentaje-->\n            <ng-container matColumnDef=\"porcentaje\">\n                <th mat-header-cell *matHeaderCellDef> Porcentaje </th>\n                <td mat-cell *matCellDef=\"let row; let index = index\" [formGroupName]=\"index\">\n                    <mat-form-field class=\"full-width\">\n                        <input matInput formControlName=\"percent\" placeholder=\"Porcentaje\" type=\"number\">\n                        <span matSuffix>%</span>\n                    </mat-form-field>\n                </td>\n                <td mat-footer-cell *matFooterCellDef> {{0.2 | percent}} </td>\n            </ng-container>\n\n            <!--Columna Boton Crear-->\n            <ng-container matColumnDef=\"add\">\n                <th mat-header-cell *matHeaderCellDef></th>\n                <td mat-cell *matCellDef=\"let row; let index = index\" [formGroupName]=\"index\">\n                    <button mat-icon-button aria-label=\"Example icon-button with a heart icon\"\n                        [disabled]=\"!isModified(index, row.value)\" (click)=\"createCost(row.value, index)\">\n                        <mat-icon>save</mat-icon>\n                    </button>\n                </td>\n                <td mat-footer-cell *matFooterCellDef></td>\n            </ng-container>\n\n            <!--Boton Eliminar-->\n            <ng-container matColumnDef=\"delete\">\n                <th mat-header-cell *matHeaderCellDef></th>                \n                <td mat-cell *matCellDef=\"let row; let index = index\" [formGroupName]=\"index\">\n                    <button mat-icon-button aria-label=\"Example icon-button with a heart icon\"\n                        (click)=\"deleteRow(index, row)\">\n                        <mat-icon>delete</mat-icon>\n                    </button>\n                </td>\n                <td mat-footer-cell *matFooterCellDef></td>\n            </ng-container>\n\n\n            <tr mat-header-row *matHeaderRowDef=\"displayedColumns\"></tr>\n            <tr mat-row *matRowDef=\"let row; columns: displayedColumns;\"></tr>\n            <tr mat-footer-row *matFooterRowDef=\"displayedColumns; sticky: true\"></tr>\n\n        </table>\n    </div>\n</form>"],"sourceRoot":"webpack:///"}