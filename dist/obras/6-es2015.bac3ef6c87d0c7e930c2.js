(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{UGCU:function(t,o,e){"use strict";e.r(o);var c=e("PCNd"),r=e("hctd"),n=e("3Pt+"),i=e("fXoL"),a=e("ofXK"),s=e("SnT8"),d=e("MSSf"),l=e("2Vo4"),b=e("eIep"),m=e("yp1H"),u=e("ffkf"),p=e("Xlwt"),f=e("tmTa"),h=e("IRfi"),w=e("A2Vd"),y=e("TY1r");const g=[3,"formGroup"],C=["mat-raised-button","","color","primary","type","button",3,"click"],Z=["mat-table","","formArrayName","costs",1,"mat-elevation-z8",3,"dataSource"],G=["matColumnDef","gasto"],D=["mat-header-cell","",4,"matHeaderCellDef"],v=["mat-cell","",3,"formGroupName",4,"matCellDef"],I=["mat-footer-cell","",4,"matFooterCellDef"],S=["matColumnDef","porcentaje"],R=["matColumnDef","add"],V=["matColumnDef","delete"],j=["mat-header-row","",4,"matHeaderRowDef"],H=["mat-row","",4,"matRowDef","matRowDefColumns"],k=["mat-footer-row","",4,"matFooterRowDef","matFooterRowDefSticky"],x=["mat-header-cell",""];function M(t,o){1&t&&(i.bc(0,"th",x),i.Hc(1," Gasto "),i.Zb())}const P=["mat-cell","",3,"formGroupName"],O=[1,"full-width"],N=["matInput","","formControlName","description","placeholder","Descripci\xf3n"];function F(t,o){1&t&&(i.bc(0,"td",P),i.bc(1,"mat-form-field",O),i.Vb(2,"input",N),i.Zb(),i.Zb()),2&t&&i.rc("formGroupName",o.index)}const X=["mat-footer-cell",""];function _(t,o){1&t&&(i.bc(0,"td",X),i.Hc(1," AIU "),i.Zb())}function A(t,o){1&t&&(i.bc(0,"th",x),i.Hc(1," Porcentaje "),i.Zb())}const U=["matInput","","formControlName","percent","placeholder","Porcentaje","type","number"],B=["matSuffix",""];function Y(t,o){1&t&&(i.bc(0,"td",P),i.bc(1,"mat-form-field",O),i.Vb(2,"input",U),i.bc(3,"span",B),i.Hc(4,"%"),i.Zb(),i.Zb(),i.Zb()),2&t&&i.rc("formGroupName",o.index)}function T(t,o){1&t&&(i.bc(0,"td",X),i.Hc(1),i.nc(2,"percent"),i.Zb()),2&t&&(i.yc(1),i.Jc(" ",i.oc(2,1,.2)," "))}function $(t,o){1&t&&i.Vb(0,"th",x)}const q=["mat-icon-button","","aria-label","Example icon-button with a heart icon",3,"disabled","click"];function E(t,o){if(1&t){const t=i.cc();i.bc(0,"td",P),i.bc(1,"button",q),i.hc("click",(function(e){i.wc(t);const c=o.$implicit,r=o.index;return i.mc().createCost(c.value,r)})),i.bc(2,"mat-icon"),i.Hc(3,"save"),i.Zb(),i.Zb(),i.Zb()}if(2&t){const t=o.$implicit,e=o.index,c=i.mc();i.rc("formGroupName",e),i.yc(1),i.rc("disabled",!c.isModified(e,t.value))}}function J(t,o){1&t&&i.Vb(0,"td",X)}function z(t,o){1&t&&i.Vb(0,"th",x)}const K=["mat-icon-button","","aria-label","Example icon-button with a heart icon",3,"click"];function L(t,o){if(1&t){const t=i.cc();i.bc(0,"td",P),i.bc(1,"button",K),i.hc("click",(function(e){i.wc(t);const c=o.index,r=o.$implicit;return i.mc().deleteRow(c,r)})),i.bc(2,"mat-icon"),i.Hc(3,"delete"),i.Zb(),i.Zb(),i.Zb()}2&t&&i.rc("formGroupName",o.index)}function Q(t,o){1&t&&i.Vb(0,"td",X)}const W=["mat-header-row",""];function tt(t,o){1&t&&i.Vb(0,"tr",W)}const ot=["mat-row",""];function et(t,o){1&t&&i.Vb(0,"tr",ot)}const ct=["mat-footer-row",""];function rt(t,o){1&t&&i.Vb(0,"tr",ct)}let nt=(()=>{class t{constructor(t,o,e){this.formBuilder=t,this.proyectoService=o,this.costoIndirectoService=e,this.costs=[],this.costsForm=this.formBuilder.array([]),this.dataSource=new l.a([]),this.displayedColumns=["gasto","porcentaje","add","delete"]}ngOnInit(){this.form=this.formBuilder.group({costs:this.costsForm}),this.proyectoService.project$.pipe(Object(b.a)(t=>(this.proyecto=t,this.costoIndirectoService.getCostoIndirectoByProyectoId(t.id)))).subscribe(t=>{this.costs=t.model,this.costs.forEach(t=>this.addRow(t,!1)),this.updateView()})}getTotalPercent(){return this.costs.map(t=>t.porcentaje).reduce((t,o)=>t+o,0)}addRow(t,o){const e=this.formBuilder.group({description:[t?t.descripcion:null,n.o.required],percent:[t?100*t.porcentaje:0,n.o.required]});this.costsForm.push(e),o||this.updateView()}updateView(){this.dataSource.next(this.costsForm.controls)}deleteRow(t){this.costsForm.removeAt(t),this.updateView()}createCost(t,o){if(console.log(t),o>=this.costs.length){const o={id:0,descripcion:t.description,porcentaje:t.percent/100,proyectoId:this.proyecto.id};this.costoIndirectoService.postCostoIndirecto(o).subscribe(t=>{console.log(t),this.costs.push(t.model)},t=>{console.error(t.error)}),console.log(o)}else{const e={id:this.costs[o].id,descripcion:t.description,porcentaje:t.percent/100,proyectoId:this.proyecto.id};this.costoIndirectoService.putCostoIndirecto(e).subscribe(t=>{console.log(t),this.costs[o]=e},t=>{console.error(t.error)})}}isModified(t,o){return t>=this.costs.length||o.description!==this.costs[t].descripcion||o.percent/100!==this.costs[t].porcentaje||void 0}}return t.ngComponentDef=i.Ob({type:t,selectors:[["app-table-aiu"]],factory:function(o){return new(o||t)(i.Ub(n.c),i.Ub(m.a),i.Ub(u.a))},consts:24,vars:6,template:function(t,o){1&t&&(i.bc(0,"form",g),i.bc(1,"button",C),i.hc("click",(function(t){return o.addRow()})),i.Hc(2,"Add row"),i.Zb(),i.bc(3,"div"),i.bc(4,"table",Z),i.Yb(5,G),i.Gc(6,M,2,0,"th",D),i.Gc(7,F,3,1,"td",v),i.Gc(8,_,2,0,"td",I),i.Xb(),i.Yb(9,S),i.Gc(10,A,2,0,"th",D),i.Gc(11,Y,5,1,"td",v),i.Gc(12,T,3,3,"td",I),i.Xb(),i.Yb(13,R),i.Gc(14,$,1,0,"th",D),i.Gc(15,E,4,2,"td",v),i.Gc(16,J,1,0,"td",I),i.Xb(),i.Yb(17,V),i.Gc(18,z,1,0,"th",D),i.Gc(19,L,4,1,"td",v),i.Gc(20,Q,1,0,"td",I),i.Xb(),i.Gc(21,tt,1,0,"tr",j),i.Gc(22,et,1,0,"tr",H),i.Gc(23,rt,1,0,"tr",k),i.Zb(),i.Zb(),i.Zb()),2&t&&(i.rc("formGroup",o.form),i.yc(4),i.rc("dataSource",o.dataSource),i.yc(21),i.rc("matHeaderRowDef",o.displayedColumns),i.yc(22),i.rc("matRowDefColumns",o.displayedColumns),i.yc(23),i.rc("matFooterRowDef",o.displayedColumns)("matFooterRowDefSticky",!0))},directives:[n.p,n.k,n.e,p.b,f.n,n.b,f.c,f.i,f.b,f.e,f.k,f.m,f.g,f.h,f.a,n.f,h.b,w.b,n.a,n.j,n.d,f.d,n.m,h.f,y.a,f.j,f.l,f.f],pipes:[a.q],styles:[".container[_ngcontent-%COMP%]{overflow:auto}table[_ngcontent-%COMP%]{width:100%;margin-top:15px}tr.mat-footer-row[_ngcontent-%COMP%]{font-weight:700}.mat-table-sticky[_ngcontent-%COMP%]{border-top:1px solid #e0e0e0}mat-form-field[_ngcontent-%COMP%]{width:80%}"]}),t})();var it=e("Xabv");const at=["cols","3","rowHeight","200px"],st=[3,"colspan","rowspan"],dt=[1,"full-width","full-height"];let lt=(()=>{class t{constructor(){}ngOnInit(){}}return t.ngComponentDef=i.Ob({type:t,selectors:[["app-aiu"]],factory:function(o){return new(o||t)},consts:15,vars:4,template:function(t,o){1&t&&(i.bc(0,"mat-grid-list",at),i.bc(1,"mat-grid-tile",st),i.bc(2,"mat-card",dt),i.bc(3,"mat-card-header"),i.bc(4,"mat-card-title"),i.Hc(5," Componentes de Costos Indirecto "),i.Zb(),i.Zb(),i.bc(6,"mat-card-content"),i.Vb(7,"app-table-aiu"),i.Zb(),i.Zb(),i.Zb(),i.bc(8,"mat-grid-tile",st),i.bc(9,"mat-card",dt),i.bc(10,"mat-card-header"),i.bc(11,"mat-card-title"),i.Hc(12," Costos "),i.Zb(),i.Zb(),i.bc(13,"mat-card-content"),i.Vb(14,"app-table-cost"),i.Zb(),i.Zb(),i.Zb(),i.Zb()),2&t&&(i.yc(1),i.rc("colspan",2)("rowspan",2),i.yc(8),i.rc("colspan",1)("rowspan",2))},directives:[s.a,s.c,d.a,d.d,d.f,d.c,nt,it.a],styles:[".full-width[_ngcontent-%COMP%]{width:100%}.full-height[_ngcontent-%COMP%]{height:100%}"]}),t})();var bt=e("tyNb");const mt=[{path:"",component:lt}];let ut=(()=>{class t{}return t.ngModuleDef=i.Sb({type:t}),t.ngInjectorDef=i.Rb({factory:function(o){return new(o||t)},imports:[[bt.d.forChild(mt)],bt.d]}),t})();bt.d.forChild(mt),e.d(o,"AiuModule",(function(){return pt}));let pt=(()=>{class t{}return t.ngModuleDef=i.Sb({type:t}),t.ngInjectorDef=i.Rb({factory:function(o){return new(o||t)},imports:[[a.c,ut,c.a,n.n,r.a]]}),t})()}}]);